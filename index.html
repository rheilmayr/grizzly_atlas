<!DOCTYPE html>

<html>

<head>

    <title>Leaflet Web Map</title>
    
    <meta charset="utf-8" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
    integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
    crossorigin=""/>
    
    <script src="https://unpkg.com/esri-leaflet@2.0.8"></script>
    
    
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
    integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
    crossorigin=""></script>
    
    <script src= 'js/Control.OSMGeocoder.js'></script>
    <script src= 'js/leaflet.markercluster-src.js'></script>
    <script src= 'js/obs.js'></script>
    <script src= 'js/JQuery.js'></script>
    <script src= 'js/SliderControl.js'></script>
    <script src= 'js/layersupport.js'></script>
    <link rel="stylesheet" href="css/MarkerCluster.css" />
	<link rel="stylesheet" href="css/MarkerCluster.Default.css" />
    <link rel = "stylesheet" href = 'css/Control.OSMGeocoder.css'/> 
    <link rel = "stylesheet" href = 'css/JQuery.css'/> 
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">

    

    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
        
</head>
    
		

<body>
    <div id="map"></div>         
    
    <script>

        
        var Esri_NatGeoWorldMap = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}', {
	        attribution: 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC',
            minZoom:6,
            maxZoom: 16
            });

        var Stamen_Watercolor = L.tileLayer('http://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.{ext}', {
	        attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
	        subdomains: 'abcd',
	        minZoom: 6,
            maxZoom: 16,
	        ext: 'png'
        });   
        
        var Icon = L.Icon.extend({
        options: {    
        iconSize: [50, 55],
        iconAnchor: [22, 50],
        popupAnchor: [-3, -14]
        }
        });
    
        var city = new Icon({iconUrl: 'images/city.png'});

        var cities = L.marker([34.26112, -116.8456], {icon: city})
        .bindPopup( '<a href="' + "https://en.wikipedia.org/wiki/Big_Bear_Lake,_California" + '" target="_blank">' + "Big Bear Lake" + '</a>' );
        
        var citymarkers = L.layerGroup(cities);
        
        var map = L.map('map',{
                layers: [Esri_NatGeoWorldMap]
            },{scrollWheelZoom:false}).setView([36.7675, -120.0026], 6);

        var baseLayers = {
	        "Terrain": Esri_NatGeoWorldMap,
	        "WaterColor": Stamen_Watercolor
         };    
        
        var overlayMaps = {
            "Cities": citymarkers
            };

        L.control.layers(baseLayers, overlayMaps).addTo(map);
        
                

        var markers = L.markerClusterGroup();       
  
        function onEachFeature(feature, layer) {
            time = parseInt(feature.properties.Year);
            if (time < 1800) {
                var before1800 = new L.LayerGroup();
                layer.addTo(before1800);
            }
            if (time >= 1800 && time < 1825) {
                var from1800to1825 = new L.LayerGroup();
                layer.addTo(from1800to1825);
            }
            if (time >= 1825 && time < 1850) {
                var from1825to1850 = new L.LayerGroup();
                layer.addTo(from1825to1850);  
            } 
            if (time >= 1850 && time < 1875) {
                var from1850to1875 = new L.LayerGroup();
                layer.addTo(from1850to1875);  
            }  
            if (time >= 1875 && time < 1900) {
                var from1875to1900 = new L.LayerGroup();
                layer.addTo(from1875to1900);
            }
            if (time >= 1900) {
                var past1900 = new L.LayerGroup();
                layer.addTo(past1900); 
            }
            if (time == null){
                layer.addTo(past1900);
            }
                  
            if (feature.properties.EncounterType && feature.properties.Year)
                {
                layer.bindPopup(feature.properties.EncounterType + " in " + feature.properties.Year)
            
            ;}
            }
        
        function style(feature){
            switch (feature.properties.EncounterType) {
                case 'Shooting' ||  'Hunting':
                return {
                    color: "#FF0000"
                };
                case 'Sighting':
                return {
                    color: "#0000FF"
                };
                case 'Attack' || 'livestock' || 'Chased' :
                return {
                    color: "#FFa500"
                };
                default:
                return {
                    color: "#0000FF"
                }
            }
            }
   
 
        var geoJsonLayer= L.geoJSON(storer, {
            pointToLayer: function (geoJsonPoint, latlng) {
            return L.circleMarker(latlng);
            },
                onEachFeature: onEachFeature,
                style: style,
                fillcolor: style
            });
           

        markers.addLayer(geoJsonLayer);
        map.addLayer(markers);
        map.fitBounds(markers.getBounds());

        var osmGeocoder = new L.Control.OSMGeocoder({placeholder: 'Search location...'});
        map.addControl(osmGeocoder);

        
                

    </script>

</body>

</html>